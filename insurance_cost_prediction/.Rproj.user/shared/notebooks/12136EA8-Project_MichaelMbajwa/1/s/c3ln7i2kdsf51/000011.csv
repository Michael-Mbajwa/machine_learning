"0","# I will perform a 10-fold cross validation to find the best model"
"0","set.seed(123)"
"0","ctrl <- caret::trainControl(method = ""cv"",  number = 10) "
"0",""
"0","# CV bagged model"
"0","bagged_cv <- caret::train("
"0","  charges ~ .,"
"0","  data = train,"
"0","  method = ""treebag"","
"0","  trControl = ctrl,"
"0","  importance = TRUE"
"0","  )"
"0",""
"0","# Let's evaluate the best model"
"0","bagged_cv_predicted <- predict(bagged_cv, test)"
"0",""
"0","# calculate evaluation metrics"
"0","bagged_cv_mae <- MLmetrics::MAE(bagged_cv_predicted, test$charges) # Mean Absolute Error (MAE)"
"0","bagged_cv_Rmse <- MLmetrics::RMSE(bagged_cv_predicted, test$charges) # Root Mean Square Error (RMSE)"
"0","bagged_cv_R2 <- MLmetrics::R2_Score(bagged_cv_predicted, test$charges) # adjusted r2 score"
"0",""
"0","# result"
"0","bagged_cv_result <- cbind(""MAE"" = bagged_cv_mae, ""RMSE"" = bagged_cv_Rmse, ""R2 score"" = bagged_cv_R2)"
"0","bagged_cv_result"
"1","    "
"1","      MAE"
"1","     RMSE"
"1"," R2 score"
"1","
[1,]"
"1"," 3046.297"
"1"," 4931.034"
"1"," 0.830321"
"1","
"
"0","# the bagging model is an improvement on all other models except the polynomial regression"
